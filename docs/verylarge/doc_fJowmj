====VENUS-P====
VENUS-P was an international X.25 network that operated from April 1982 through March 2006. At its subscription peak in 1999, VENUS-P connected 207 networks in 87 countries.&lt;ref&gt;[http://www.kddi.com/english/corporate/news_release/2005/1109/ &quot;KDDI to Close VENUS-P International Public Data Communications Service&quot;] {{webarchive|url=https://archive.is/20130904020803/http://www.kddi.com/english/corporate/news_release/2005/1109/ |date=2013-09-04 }}, KDDI, 9 November 2005. Retrieved 3 September 2013.&lt;/ref&gt;

====Venepaq====
Venepaq is the national X.25 public network in Venezuela. It is run by [[Cantv]] and allow direct connection and dial up connections. Provides nationalwide access at very low cost. It provides national and international access. Venepaq allow connection from 19.2 kbit/s to 64 kbit/s in direct connections, and 1200, 2400 and 9600 bit/s in dial up connections.

===Internet era===
{{Internet}}
When [[Internet]] connectivity was made available to anyone who could pay for an [[Internet Service Provider|ISP]] subscription, the distinctions between national networks blurred. The user no longer saw network identifiers such as the DNIC. Some older technologies such as [[circuit switching]] have resurfaced with new names such as [[fast packet switching]]. Researchers have created some experimental networks to complement the existing Internet.&lt;ref name=&quot;Mike C. Smith&quot;&gt;{{cite web | url=https://www.networkworld.com/article/3221478/internet/what-is-dedicated-internet-access.html | title=What is Dedicated Internet Access? | date=7 September 2017 | access-date=21 December 2018 | author= Mike C. Smith}}&lt;/ref&gt;

====CSNET====
The [[CSNET|Computer Science Network]] (CSNET) was a computer network funded by the U.S. National Science Foundation (NSF) that began operation in 1981. Its purpose was to extend networking benefits, for [[computer science]] departments at academic and research institutions that could not be directly connected to [[ARPANET]], due to funding or authorization limitations. It played a significant role in spreading awareness of, and access to, national networking and was a major milestone on the path to development of the global [[Internet]].&lt;ref name=&quot;nsf&quot;&gt;{{Cite web |title= The Internet—From Modest Beginnings |work= NSF website |url= https://www.nsf.gov/about/history/nsf0050/internet/modest.htm |access-date= September 30, 2011 |url-status= dead |archive-url= https://web.archive.org/web/20110828125922/https://www.nsf.gov/about/history/nsf0050/internet/modest.htm |archive-date= August 28, 2011 }}&lt;/ref&gt;&lt;ref&gt;{{Cite journal |title= History and overview of CSNET |author= Douglas Comer |journal= Communications |date= October 1983 |volume= 26 |number= 10 |doi= 10.1145/358413.358423 |pages=747–753|s2cid= 11943330 |author-link= Douglas Comer }}&lt;/ref&gt;

====Internet2====
[[Internet2]] is a not-for-profit United States [[computer network]]ing [[consortium]] led by members from the research and education communities, industry, and government.&lt;ref&gt;[http://internet2.edu/about &quot;About Internet2&quot;], Retrieved on 2009-06-26&lt;/ref&gt; The Internet2 community, in partnership with [[Qwest]], built the first Internet2 Network, called [[Abilene Network|Abilene]], in 1998 and was a prime investor in the [[National LambdaRail]] (NLR) project.&lt;ref&gt;[https://archive.is/20120710234213/http://news.com.com/Optical%20networking%20The%20next%20generation/2100-1033-5403589.html?part=dht&amp;tag=ntop&amp;tag=nl.e703 &quot;Optical networking: The next generation&quot;], Marguerite Reardon, ''CNET News'', October 11, 2004&lt;/ref&gt; In 2006, Internet2 announced a partnership with [[Level 3 Communications]] to launch a brand new nationwide network, boosting its capacity from 10 Gbit/s to 100 Gbit/s.&lt;ref&gt;[https://www.usatoday.com/tech/news/techinnovations/2007-10-11-faster-internet2_N.htm &quot;Speedy Internet2 gets 10x boost&quot;], Anick Jesdanun (AP), USAToday.com, October 11, 2007, Retrieved 26 June 2009.&lt;/ref&gt; In October, 2007, Internet2 officially retired Abilene and now refers to its new, higher capacity network as the Internet2 Network.

====NSFNET====
[[File:NSFNET-traffic-visualization-1991.jpg|thumb|right|NSFNET Traffic 1991, NSFNET backbone nodes are shown at the top, regional networks below, traffic volume is depicted from purple (zero bytes) to white (100 billion bytes), visualization by [[National Center for Supercomputing Applications|NCSA]] using traffic data provided by the [[Merit Network]].]]
{{Main |NSFNET}}

The National Science Foundation Network (NSFNET) was a program of coordinated, evolving projects sponsored by the [[National Science Foundation]] (NSF) beginning in 1985 to promote advanced research and education networking in the United States.&lt;ref&gt;[http://www.nsfnet-legacy.org/ NSFNET: The Partnership That Changed The World], Web site for an event held to celebrate the NSFNET, November 2007&lt;/ref&gt; NSFNET was also the name given to several nationwide backbone networks operating at speeds of 56 kbit/s, 1.5 Mbit/s (T1), and 45 Mbit/s (T3) that were constructed to support NSF's networking initiatives from 1985-1995. Initially created to link researchers to the nation's NSF-funded supercomputing centers, through further public funding and private industry partnerships it developed into a major part of the [[Internet backbone]].

====NSFNET regional networks====
In addition to the five NSF supercomputer centers, NSFNET provided connectivity to eleven regional networks and through these networks to many smaller regional and campus networks in the United States. The NSFNET regional networks were:&lt;ref name=ConneXions-April1996&gt;[http://www.merit.edu/research/nsfnet_article.php &quot;Retiring the NSFNET Backbone Service: Chronicling the End of an Era&quot;] {{webarchive|url=https://web.archive.org/web/20130817124939/http://merit.edu/research/nsfnet_article.php |date=2013-08-17 }}, Susan R. Harris and Elise Gerich, ''ConneXions'', Vol. 10, No. 4, April 1996&lt;/ref&gt;&lt;ref&gt;[http://www.nsfnet-legacy.org/archives/06--Community.pdf &quot;NSFNET: The Community&quot;], panel presentation slides, [[Doug Gale]] moderator, NSFNET: The Partnership That Changed The World, 29 November 2007&lt;/ref&gt;
*BARRNet, the Bay Area Regional Research Network in [[Palo Alto, California]];
*CERFNET, [[California Education and Research Federation Network]] in [[San Diego, California]], serving California and Nevada;
*CICNet, the [[Committee on Institutional Cooperation]] Network via the Merit Network in [[Ann Arbor, Michigan]] and later as part of the T3 upgrade via [[Argonne National Laboratory]] outside of [[Chicago]], serving the [[Big Ten]] Universities and the [[University of Chicago]] in Illinois, Indiana, Michigan, Minnesota, Ohio, and Wisconsin;
*[[Merit Network|Merit/MichNet]] in [[Ann Arbor, Michigan]] serving Michigan, formed in 1966, still in operation as of 2016;&lt;ref name=Merit1998PartOne&gt;[http://www.merit.edu/about/history/pdf/MeritHistory.pdf &quot;Merit–Who, What, and Why, Part One: The Early Years, 1964-1983&quot;] {{webarchive|url=https://web.archive.org/web/20130423042006/http://merit.edu/about/history/pdf/MeritHistory.pdf |date=2013-04-23 }}, Eric M. Aupperle, Merit Network, Inc., in ''Library Hi Tech'', vol. 16, No. 1 (1998)&lt;/ref&gt;
*MIDnet in [[Lincoln, Nebraska]] serving Arkansas, Iowa, Kansas, Missouri, Nebraska, Oklahoma, and South Dakota;
*[[NEARNET]], the New England Academic and Research Network in [[Cambridge, Massachusetts]], added as part of the upgrade to T3, serving Connecticut, Maine, Massachusetts, New Hampshire, Rhode Island, and Vermont, established in late 1988, operated by [[BBN Technologies|BBN]] under contract to MIT, BBN assumed responsibility for NEARNET on 1 July 1993;&lt;ref&gt;[http://web.mit.edu/newsoffice/1993/bbn-0714.html &quot;BBN to operate NEARnet&quot;], ''MIT News'', 14 July 1993&lt;/ref&gt;
*NorthWestNet in [[Seattle, Washington]], serving Alaska, Idaho, Montana, North Dakota, Oregon, and Washington, founded in 1987;&lt;ref&gt;[http://www.gutenberg.org/files/40/40-ps.ps &quot;About NorthWestNet&quot;], ''NorthWestNet User Services Internet Resource Guide'', NorthWestNet Academic Computing Consortium, Inc., 24 March 1992 accessed 3 July 2012&lt;/ref&gt;
*[[NYSERNet]], New York State Education and Research Network in [[Ithaca, New York]];
*JVNCNet, the John von Neumann National Supercomputer Center Network in [[Princeton, New Jersey]], serving Delaware and New Jersey;
*SESQUINET, the Sesquicentennial Network in [[Houston, Texas]], founded during the 150th anniversary of the State of [[Texas]];
*[[SURAnet]], the Southeastern Universities Research Association network in [[College Park, Maryland]] and later as part of the T3 upgrade in [[Atlanta, Georgia]] serving Alabama, Florida, Georgia, Kentucky, Louisiana, Maryland, Mississippi, North Carolina, South Carolina, Tennessee, Virginia, and West Virginia, sold to [[BBN Technologies|BBN]] in 1994; and
*Westnet in [[Salt Lake City, Utah]] and [[Boulder, Colorado]], serving Arizona, Colorado, New Mexico, Utah, and Wyoming.

====National LambdaRail====
The [[National LambdaRail]] was launched in September 2003. It is a 12,000-mile high-speed national computer network owned and operated by the U.S. research and education community that runs over fiber-optic lines. It was the first transcontinental [[10 Gigabit Ethernet]] network. It operates with high aggregate capacity of up to 1.6 Tbit/s and a high 40&amp;nbsp;Gbit/s bitrate, with plans for 100&amp;nbsp;Gbit/s.&lt;ref&gt;{{Cite news |title= National LambdaRail Opens for Business |author= Michael Feldman |work= HPCwire |date= October 28, 2008 |url= http://www.hpcwire.com/hpcwire/2008-10-28/national_lambdarail_opens_for_business.html |access-date= June 6, 2013}}&lt;/ref&gt;&lt;ref&gt;[http://www.nlr.net/about.php &quot;About NLR&quot;] {{webarchive|url=https://archive.is/20130904020736/http://www.nlr.net/about.php |date=2013-09-04 }}, National LambdaRail, 3 September 2013.&lt;/ref&gt; The upgrade never took place and NLR ceased operations in March 2014.

====TransPAC, TransPAC2, and TransPAC3====
[[TransPAC2]] and TransPAC3, continuations of the TransPAC project, a high-speed international Internet service connecting research and education networks in the Asia-Pacific region to those in the US.&lt;ref&gt;[http://www.hpcwire.com/hpcwire/2005-04-08/international_transpac2_inaugurated-1.html &quot;International TransPAC2 Inaugurated&quot;] {{webarchive|url=https://archive.is/20130620034322/http://www.hpcwire.com/hpcwire/2005-04-08/international_transpac2_inaugurated-1.html |date=2013-06-20 }}, ''HPC Wire'', 8 April 2005.&lt;/ref&gt;&lt;ref&gt;[http://www.transpac.org/index.php &quot;TransPAC website&quot;]. Retrieved 3 September 2013.&lt;/ref&gt; TransPAC is part of the NSF’s International Research Network Connections (IRNC) program.&lt;ref&gt;[http://www.irnclinks.net/#transpac3 &quot;TransPAC3 - Asia-US High Performance International Networking&quot;], International Research Network Connections Program (IRNC), U.S. National Science Foundation, October 2011. Retrieved 3 September 2013.&lt;/ref&gt;

====Very high-speed Backbone Network Service (vBNS)====
The [[Very high-speed Backbone Network Service]] (vBNS) came on line in April 1995 as part of a [[National Science Foundation]] (NSF) sponsored project to provide high-speed interconnection between NSF-sponsored [[Supercomputer|supercomputing]] centers and select access points in the United States.&lt;ref&gt;[http://w2.eff.org/Infrastructure/Govt_docs/nsf_nren.rfp NSF Solicitation 93-52] {{webarchive|url=https://web.archive.org/web/20160305030153/https://w2.eff.org/Infrastructure/Govt_docs/nsf_nren.rfp |date=2016-03-05 }} - Network Access Point Manager, Routing Arbiter, Regional Network Providers, and Very High Speed Backbone Network Services Provider for NSFNET and the NREN(SM) Program, May 6, 1993&lt;/ref&gt; The network was engineered and operated by [[MCI Communications|MCI Telecommunications]] under a cooperative agreement with the NSF. By 1998, the vBNS had grown to connect more than 100 universities and research and engineering institutions via 12 national points of presence with [[Digital Signal 3|DS-3]] (45 Mbit/s), [[OC3#OC-3|OC-3c]] (155 Mbit/s), and [[OC12#OC-12 / STM-4|OC-12c]] (622 Mbit/s) links on an all OC-12c backbone, a substantial engineering feat for that time. The vBNS installed one of the first ever production [[Optical Carrier transmission rates#OC-48 / STM-16 / G SONET|OC-48c]] (2.5 Gbit/s) [[Internet Protocol|IP links]] in February 1999 and went on to upgrade the entire backbone to OC-48c.&lt;ref&gt;[http://ieeexplore.ieee.org/iel4/6/15108/00694354.pdf?arnumber=694354 &quot;vBNS: not your father's Internet&quot;], John Jamison, Randy Nicklas, Greg Miller, Kevin Thompson, Rick Wilder, Laura Cunningham and Chuck Song, ''IEEE Spectrun'', Volume 35 Issue 7 (July 1998), pp. 38-46.&lt;/ref&gt;

In June 1999 MCI WorldCom introduced vBNS+ which allowed attachments to the vBNS network by organizations that were not approved by or receiving support from NSF.&lt;ref&gt;[http://www.verizonbusiness.com/about/news/pr-5449-en-MCI+WorldCom+Introduces+Next+Generation+vBNS%2B+For+All+Higher+Education+And+Research+Organizations.xml &quot;MCI WorldCom Introduces Next Generation vBNS+ For All Higher Education And Research Organizations&quot;], ''Verizon Business News'', June 23, 1999&lt;/ref&gt; After the expiration of the NSF agreement, the vBNS largely transitioned to providing service to the government. Most universities and research centers migrated to the Internet2 educational backbone. In January 2006, when [[MCI Inc.|MCI]] and [[Verizon]] merged,&lt;ref&gt;[http://www.verizonbusiness.com/about/news/pr-18593-en-Verizon+and+MCI+Close+Merger,+Creating+a+Stronger+Competitor+for+Advanced+Communications+Services.xml &quot;Verizon and MCI Close Merger, Creating a Stronger Competitor for Advanced Communications Services&quot;], ''Verizon Business News'', January 6, 2006&lt;/ref&gt; vBNS+ became a service of [[Verizon Business]].&lt;ref&gt;[http://www.verizonbusiness.com/solutions/government/federal/contracts/fts2001_bridge/rg_products/vbns/ vBNS+], at http://www.verizonbusiness.com Home &gt; Solutions &gt; Government &gt; Federal Government &gt; Contract Vehicles &gt; FTS2001 Bridge &gt; Products&lt;/ref&gt;

==See also==
*[[CompuServe]]
*[[Multi-bearer network]]
*[[Optical burst switching]]
*[[Packet radio]]
*[[Public switched data network]]
*[[Time-Driven Switching]] - a bufferless approach to packet switching
*[[Transmission delay]]
*[[Virtual private network]]

==References==
{{Reflist}}
{{refbegin}}
* {{FOLDOC}}
{{refend}}

===Bibliography===
*Paul Baran et al., ''[http://www.rand.org/about/history/baran-list.html On Distributed Communications, Volumes I-XI]'' (RAND Corporation Research Documents, August, 1964)
**Paul Baran, ''[http://www.rand.org/publications/RM/RM3420/ On Distributed Communications: I Introduction to Distributed Communications Network]'' (RAND Memorandum RM-3420-PR. August 1964)
*Paul Baran, [http://www.cs.ucla.edu/classes/cs217/Baran64.pdf On Distributed Communications Networks], ([[IEEE]] Transactions on Communications Systems, Vol. CS-12 No. 1, pp.&amp;nbsp;1–9, March 1964)
*D. W. Davies, K. A. Bartlett, R. A. Scantlebury, and P. T. Wilkinson, ''A digital communications network for computers giving rapid response at remote terminals'' (ACM Symposium on Operating Systems Principles. October 1967)
*R. A. Scantlebury, P. T. Wilkinson, and K. A. Bartlett, ''The design of a message switching Centre for a digital communication network'' (IFIP 1968)
*Lawrence Roberts, ''[https://web.archive.org/web/20160324033133/http://www.packet.cc/files/ev-packet-sw.html The Evolution of Packet Switching]'' (Proceedings of the IEEE, November, 1978)

==Further reading==
*{{Citation |last= Abbate |first= Janet |title= Inventing the Internet |publisher= MIT Press |year= 2000 |isbn= 9780262511155 |url-access= registration |url= https://archive.org/details/inventinginterne00jane }}
*Hafner, Katie ''Where Wizards Stay Up Late'' (Simon and Schuster, 1996) pp 52–67
*Norberg, Arthur; O'Neill, Judy E. ''Transforming Computer Technology: Information Processing for the Pentagon, 1962-1982'' (Johns Hopkins University, 1996)

==External links==
*{{Citation | last = Wilkinson | first = Peter | title = Packet Switching and the NPL Network | journal = Computer Resurrection: The Journal of the Computer Conservation Society | issue = 90 | date = Summer 2020 | year = 2020 | url = https://www.computerconservationsociety.org/resurrection/res90.htm#c | issn = 0958-7403 }}
*[http://purl.umn.edu/107101 Oral history interview with Paul Baran]. [[Charles Babbage Institute]] University of Minnesota, Minneapolis. Baran describes his working environment at RAND, as well as his initial interest in survivable communications, and the evolution, writing and distribution of his eleven-volume work, &quot;On Distributed Communications&quot;. Baran discusses his interaction with the group at ARPA who were responsible for the later development of the ARPANET.
*[https://www.youtube.com/watch?v=L_ojeeTIqFM&amp;index=29&amp;list=PL59D1CD3E3C7C070F NPL Data Communications Network] NPL video, 1970s
*[http://www.livinginternet.com/i/iw_packet.htm Packet Switching History and Design], site reviewed by Baran, Roberts, and Kleinrock
*[http://www.rand.org/about/history/baran.html Paul Baran and the Origins of the Internet]
*[http://www.rogerdmoore.ca/PS 20+ articles on packet switching in the 1970s]
*[http://www.phrack.org/issues.html?issue=18&amp;id=3#article &quot;An Introduction to Packet Switched Networks&quot;, ''Phrack'', 05/3/88]

{{Telecommunications}}
{{Authority control}}
{{DEFAULTSORT:Packet Switching}}
[[Category:Computer networking]]
[[Category:History of the Internet]]
[[Category:Network protocols]]
[[Category:Packets (information technology)| ]]</text>
      <sha1>6n5qegesmdqs4abl87bc8biau3rhuob</sha1>
    </revision>
  </page>
  <page>
    <title>IPsec</title>
    <ns>0</ns>
    <id>43342</id>
    <revision>
      <id>991319492</id>
      <parentid>991318577</parentid>
      <timestamp>2020-11-29T12:53:39Z</timestamp>
      <contributor>
        <username>Frap</username>
        <id>612852</id>
      </contributor>
      <comment>/* Key exchange algorithms */</comment>
      <model>wikitext</model>
      <format>text/x-wiki</format>
      <text bytes="45922" xml:space="preserve">{{IPstack}}{{short description|Secure network protocol suite}}
In [[computing]], '''Internet Protocol Security''' ('''IPsec''') is a secure network [[protocol suite]] that [[authentication|authenticates]] and [[encryption|encrypts]] the [[packet (information technology)|packets]] of data to provide secure encrypted communication between two computers over an [[Internet Protocol]] network. It is used in [[virtual private network]]s (VPNs).

IPsec includes protocols for establishing [[mutual authentication]] between agents at the beginning of a session and negotiation of [[Key (cryptography)|cryptographic key]]s to use during the session. IPsec can protect data flows between a pair of hosts (''host-to-host''), between a pair of security gateways (''network-to-network''), or between a security gateway and a host (''network-to-host'').&lt;ref name=&quot;rfc2406&quot; /&gt;
IPsec uses cryptographic security services to protect communications over [[Internet Protocol]] (IP) networks. It supports network-level peer authentication, data-origin authentication, data integrity, data confidentiality (encryption), and replay protection.

The initial [[IPv4]] suite was developed with few security provisions. As a part of the IPv4 enhancement, IPsec is a layer 3 [[OSI model]] or [[internet layer]] end-to-end security scheme. In contrast, while some other Internet security systems in widespread use operate above layer 3, such as [[Transport Layer Security]] (TLS) that operates at the Transport Layer and [[Secure Shell]] (SSH) that operates at the Application layer, IPsec can automatically secure applications at the IP layer.

==History==
Starting in the early 1970s, the [[DARPA|Advanced Research Projects Agency]] sponsored a series of experimental [[ARPANET encryption devices]], at first for native ARPANET packet encryption and subsequently for TCP/IP packet encryption; some of these were certified and fielded. From 1986 to 1991, the NSA sponsored the development of security protocols for the Internet under its Secure Data Network Systems (SDNS) program.&lt;ref&gt;{{Cite document|title=Implementation of IPSec Protocol - IEEE Conference Publication|language=en-US|doi=10.1109/ACCT.2012.64|s2cid=16526652}}&lt;/ref&gt; This brought together various vendors including Motorola who produced a network encryption device in 1988. The work was openly published from about 1988 by [[National Institute of Standards and Technology|NIST]] and, of these, ''Security Protocol at Layer 3'' (SP3) would eventually morph into the ISO standard Network Layer Security Protocol (NLSP).&lt;ref&gt;{{Cite web |url=http://www.toad.com/gnu/netcrypt.html |title=Archived copy |access-date=2014-02-18 |archive-url=https://web.archive.org/web/20140903145752/http://www.toad.com/gnu/netcrypt.html |archive-date=2014-09-03 |url-status=dead }}&lt;/ref&gt;

From 1992 to 1995, various groups conducted research into IP-layer encryption. 
*1. In 1992, the US [[Naval Research Laboratory]] (NRL) began the [[Simple Internet Protocol Plus]] (SIPP) project to research and implement IP encryption. 
*2. In 1993，at [[Columbia University]] and [[AT&amp;T Bell Labs]]，John Ioannidis and others researched the software experimental [[swIPe (protocol)|Software IP Encryption Protocol]] (swIPe) on [[SunOS]].  
*3. In 1993, Sponsored by Whitehouse internet service project, Wei Xu at [[Trusted Information Systems]] (TIS) further researched the Software IP Security Protocols and developed the hardware support for the triple DES [[Data Encryption Standard]],&lt;ref&gt;{{Cite web|url=https://www.le-vpn.com/history-of-vpn/|title=The history of VPN creation|last=|first=|date=|website=|access-date=}}&lt;/ref&gt; which was coded in the BSD 4.1 kernel and supported both x86 and SUNOS architectures. By December 1994, TIS released their [[DARPA]]-sponsored open-source Gauntlet Firewall product with the integrated [[Triple DES|3DES]] hardware encryption at over [[Digital Signal 1|T1]] speeds. It was the first-time using IPSec VPN connections between the east and west coast of the States, known as the first commercial IPSec VPN product.
*4. Under NRL's [[DARPA]]-funded research effort, NRL developed the IETF standards-track specifications (RFC 1825 through RFC 1827) for IPsec, which was coded in the BSD 4.4 kernel and supported both x86 and SPARC CPU architectures.&lt;ref&gt;&quot;http://web.mit.edu/network/isakmp/&quot;&lt;/ref&gt;  NRL's IPsec implementation was described in their paper in the 1996 USENIX Conference Proceedings.&lt;ref&gt;&quot;https://www.usenix.org/legacy/publications/library/proceedings/sd96/atkinson.html&quot;&lt;/ref&gt;  NRL's open-source IPsec implementation was made available online by MIT and became the basis for most initial commercial implementations.&lt;ref&gt;&quot;http://web.mit.edu/network/isakmp/&quot;&lt;/ref&gt;

The [[Internet Engineering Task Force]] (IETF) formed the IP Security Working Group in 1992&lt;ref&gt;{{Cite web|url=https://datatracker.ietf.org/wg/ipsec/history/|title=IETF IP Security Protocol (ipsec) Working group History|last=|first=|date=|website=|access-date=}}&lt;/ref&gt; to standardize openly specified security extensions to IP, called ''IPsec''.&lt;ref&gt;{{cite web|url=http://tools.ietf.org/html/rfc4301#page-4|title=RFC4301: Security Architecture for the Internet Protocol|date=December 2005|publisher=Network Working Group of the IETF|page=4|quote=The spelling &quot;IPsec&quot; is preferred and used throughout this and all related IPsec standards.  All other capitalizations of IPsec [...] are deprecated.}}
&lt;/ref&gt; In 1995, the working group organized a few of the workshops with members from the five companies (TIS, CISCO, FTP, etc.). During the IPSec workshops, the NRL's standards and Cisco and TIS' software are standardized as the public references, published as RFC-1825 through RFC-1827.&lt;ref&gt;{{Cite web|url=https://www.nrl.navy.mil/itd/sites/www.nrl.navy.mil.itd/files/files/itd_accomp_ipsec.pdf|title=NRL ITD Accomplishments - IPSec and IPv6|last=|first=|date=|website=US Naval Research Laboratories|access-date=}}&lt;/ref&gt;

==Security architecture== 
The IPsec is an [[open standard]] as a part of the IPv4 suite. IPsec uses the following [[Protocol (computing)|protocol]]s to perform various functions:&lt;ref name=&quot;rfc2411&quot;&gt;{{cite IETF|title=IP Security Document Roadmap|rfc=2411|last1=Thayer|first1=R.|last2=Doraswamy|first2=N.|last3=Glenn|first3=R.|date=November 1998|publisher=[[Internet Engineering Task Force|IETF]]|doi=10.17487/RFC2411}}
&lt;/ref&gt;&lt;ref name=&quot;rfc4308&quot;&gt;{{cite IETF|title=Cryptographic Suites for IPsec|publisher=[[Internet Engineering Task Force|IETF]]|last=Hoffman|first=P.|date=December 2005|rfc=4308|doi=10.17487/RFC4308}}&lt;/ref&gt;

* [[#Authentication Header|Authentication Headers (AH)]] provides connectionless [[data integrity]] and [[data origin authentication]] for IP [[datagrams]] and provides protection against [[replay attack]]s.&lt;ref name=&quot;rfc2402&quot;&gt;{{cite IETF|title=IP Authentication Header|last1=Kent|first1=S.|last2=Atkinson|first2=R.|publisher=[[Internet Engineering Task Force|IETF]]|date=November 1998|rfc=2402|doi=10.17487/RFC2402}}&lt;/ref&gt;&lt;ref name=&quot;rfc4302&quot;&gt;{{cite IETF|title=IP Authentication Header|publisher=[[Internet Engineering Task Force|IETF]]|last=Kent|first=S.|date=December 2005|rfc=4302|doi=10.17487/RFC4302}}&lt;/ref&gt;
* [[#Encapsulating Security Payload|Encapsulating Security Payloads (ESP)]] provides [[confidentiality]], connectionless data integrity, data-origin [[authentication]], an anti-replay service (a form of partial sequence integrity), and limited traffic-flow confidentiality.&lt;ref name=&quot;rfc2406&quot;&gt;{{cite IETF|title=IP Encapsulating Security Payload (ESP)|publisher=[[Internet Engineering Task Force|IETF]]|last1=Kent|first1=S.|last2=Atkinson|first2=R.|date=November 1998|rfc=2406|doi=10.17487/RFC2406}}&lt;/ref&gt;
* [[Internet Security Association and Key Management Protocol]] (ISAKMP) provides a framework for authentication and key exchange,&lt;ref name=&quot;rfc2409_sec1&quot;&gt;The [[Internet Key Exchange]] (IKE), RFC 2409, §1 Abstract&lt;/ref&gt; with actual authenticated keying material provided either by manual configuration with [[pre-shared key]]s, [[Internet Key Exchange]] (IKE and IKEv2), [[Kerberized Internet Negotiation of Keys]] (KINK), or IPSECKEY [[list of DNS record types|DNS records]].&lt;ref name=&quot;rfc2409&quot;&gt;{{cite IETF|title=The Internet Key Exchange (IKE)|publisher=[[Internet Engineering Task Force|IETF]]|last1=Harkins|first1=D.|last2=Carrel|first2=D.|date=November 1998|rfc=2409|doi=10.17487/RFC2409}}&lt;/ref&gt;&lt;ref name=&quot;rfc4306&quot;&gt;{{cite IETF|title=IKE Version 2|publisher=[[Internet Engineering Task Force|IETF]]|editor-first=C.|editor-last=Kaufman|rfc=4306|doi=10.17487/RFC4306}}&lt;/ref&gt;&lt;ref name=&quot;rfc4430&quot;&gt;{{cite IETF|title=Kerberized Internet Negotiation of Keys (KINK)|publisher=[[Internet Engineering Task Force|IETF]]|date=November 1998|rfc=4430|last1=Sakane|first1=S.|last2=Kamada|first2=K.|last3=Thomas|first3=M.|last4=Vilhuber|first4=J.|doi=10.17487/RFC4430}}&lt;/ref&gt;&lt;ref name=&quot;RFC 4025&quot;&gt;{{cite IETF|title=A Method for Storing IPsec Keying Material in DNS|publisher=[[Internet Engineering Task Force|IETF]]|date=February 2005|rfc=4025|last1=Richardson|first1=M.|doi=10.17487/RFC4025}}&lt;/ref&gt; The purpose is to generate the [[#Security association|Security Associations (SA)]] with the bundle of algorithms and parameters necessary for AH and/or ESP operations. 

===Authentication Header===
[[File:Ipsec-ah.svg|thumb|Usage of IPsec Authentication Header format in Tunnel and Transport modes]]
The Security Authentication Header ([[#Authentication Header|AH]]) was developed at the US Naval Research Laboratory in the early 1990s and is derived in part from previous IETF standards work for authentication of the [[Simple Network Management Protocol]] (SNMP) version 2. Authentication Header (AH) is a member of the IPsec protocol suite. AH ensures connectionless [[Data integrity|integrity]] by using a [[hash function]] and a secret shared key in the AH algorithm. AH also guarantees the data origin by [[authenticating]] IP [[Packet (information technology)|packet]]s. Optionally a sequence number can protect the IPsec packet's contents against [[replay attack]]s,&lt;ref&gt;{{Cite book|title= Carrier-Scale IP Networks: Designing and Operating Internet Networks|author =Peter Willis |publisher= IET|year=2001 |isbn= 9780852969823|page=270}}&lt;/ref&gt; using the [[sliding window]] technique and discarding old packets.

* In [[IPv4]], AH prevents option-insertion attacks. In [[IPv6]], AH protects both against header insertion attacks and option insertion attacks.
* In [[IPv4]], the AH protects the IP payload and all header fields of an IP datagram except for mutable fields (i.e. those that might be altered in transit), and also IP options such as the IP Security Option (RFC 1108). Mutable (and therefore unauthenticated) IPv4 header fields are [[Differentiated services code point|DSCP]]/[[Type of service|ToS]], [[Explicit Congestion Notification|ECN]], Flags, [[IP fragmentation|Fragment]] [[Offset (computer science)|Offset]], [[Time to live|TTL]] and [[IPv4 header checksum|Header Checksum]].&lt;ref name=&quot;rfc4302&quot;/&gt;
* In [[IPv6]], the AH protects most of the IPv6 base header, AH itself, non-mutable extension headers after the AH, and the IP payload. Protection for the IPv6 header excludes the mutable fields: [[Differentiated services code point|DSCP]], [[Explicit Congestion Notification|ECN]], Flow Label, and Hop Limit.&lt;ref name=rfc4302 /&gt;
AH operates directly on top of IP, using [[List of IP protocol numbers|IP protocol number 51]].&lt;ref name=&quot;iana&quot;&gt;{{cite web|url=https://www.iana.org/assignments/protocol-numbers/protocol-numbers.xml |publisher=[[Internet Assigned Numbers Authority|IANA]] |title=Protocol Numbers |date=2010-05-27 |archive-url=https://web.archive.org/web/20100529122930/https://www.iana.org/assignments/protocol-numbers/protocol-numbers.xml |archive-date=2010-05-29 |work=IANA |url-status=dead |df= }}&lt;/ref&gt;

The following AH packet diagram shows how an AH packet is constructed and interpreted:&lt;ref name=&quot;rfc2402&quot;/&gt;&lt;ref name=&quot;rfc4302&quot;/&gt;
&lt;center&gt;
{| class=&quot;wikitable&quot; style=&quot;text-align: center&quot;
|+ style=&quot;background:#781549; color:white;&quot; |''Authentication Header'' format
|-
! style=&quot;border-bottom:none; border-right:none;&quot;| ''Offsets''
! style=&quot;border-left:none;&quot;| Octet&lt;sub&gt;16&lt;/sub&gt;
! colspan=&quot;8&quot; | 0
! colspan=&quot;8&quot; | 1
! colspan=&quot;8&quot; | 2
! colspan=&quot;8&quot; | 3
|-
! style=&quot;border-top: none&quot; | Octet&lt;sub&gt;16&lt;/sub&gt;
! Bit&lt;sub&gt;10&lt;/sub&gt;
! style=&quot;width:2.6%;&quot;| 0
! style=&quot;width:2.6%;&quot;| 1
! style=&quot;width:2.6%;&quot;| 2
! style=&quot;width:2.6%;&quot;| 3
! style=&quot;width:2.6%;&quot;| 4
! style=&quot;width:2.6%;&quot;| 5
! style=&quot;width:2.6%;&quot;| 6
! style=&quot;width:2.6%;&quot;| 7
! style=&quot;width:2.6%;&quot;| 8
! style=&quot;width:2.6%;&quot;| 9
! style=&quot;width:2.6%;&quot;| 10
! style=&quot;width:2.6%;&quot;| 11
! style=&quot;width:2.6%;&quot;| 12
! style=&quot;width:2.6%;&quot;| 13
! style=&quot;width:2.6%;&quot;| 14
! style=&quot;width:2.6%;&quot;| 15
! style=&quot;width:2.6%;&quot;| 16
! style=&quot;width:2.6%;&quot;| 17
! style=&quot;width:2.6%;&quot;| 18
! style=&quot;width:2.6%;&quot;| 19
! style=&quot;width:2.6%;&quot;| 20
! style=&quot;width:2.6%;&quot;| 21
! style=&quot;width:2.6%;&quot;| 22
! style=&quot;width:2.6%;&quot;| 23
! style=&quot;width:2.6%;&quot;| 24
! style=&quot;width:2.6%;&quot;| 25
! style=&quot;width:2.6%;&quot;| 26
! style=&quot;width:2.6%;&quot;| 27
! style=&quot;width:2.6%;&quot;| 28
! style=&quot;width:2.6%;&quot;| 29
! style=&quot;width:2.6%;&quot;| 30
! style=&quot;width:2.6%;&quot;| 31
|-
! 0
! 0
| colspan=&quot;8&quot;|''Next Header''
| colspan=&quot;8&quot;|''Payload Len''
| colspan=&quot;16&quot;|''Reserved''
|-
! 4
! 32
| colspan=&quot;32&quot;|''Security Parameters Index (SPI)''
|-
! 8
! 64
| colspan=&quot;32&quot;|''Sequence Number''
|-
! C
! 96
| colspan=&quot;32&quot; rowspan=&quot;2&quot;|''Integrity Check Value (ICV)''&lt;br /&gt;...
|-
! ...
! ...
|}
&lt;/center&gt;
; ''Next Header'' (8 bits) : Type of the next header, indicating what upper-layer protocol was protected. The value is taken from the [[list of IP protocol numbers]].
; ''Payload Len'' (8 bits) : The length of this ''Authentication Header'' in 4-octet units, minus 2. For example, an AH value of 4 equals 3×(32-bit fixed-length AH fields) + 3×(32-bit ICV fields) − 2 and thus an AH value of 4 means 24 octets. Although the size is measured in 4-octet units, the length of this header needs to be a multiple of 8 octets if carried in an IPv6 packet. This restriction does not apply to an ''Authentication Header'' carried in an IPv4 packet.
; ''Reserved'' (16 bits) : Reserved for future use (all zeroes until then).
; ''Security Parameters Index'' (32 bits) : Arbitrary value which is used (together with the destination IP address) to identify the [[security association]] of the receiving party.
; &lt;span id=&quot;sequence number&quot;&gt;''Sequence Number''&lt;/span&gt; (32 bits) : A [[monotonic]] strictly increasing sequence number (incremented by 1 for every packet sent) to prevent [[replay attack]]s. When replay detection is enabled, sequence numbers are never reused, because a new security association must be renegotiated before an attempt to increment the sequence number beyond its maximum value.&lt;ref name=&quot;rfc4302&quot;/&gt;
; ''Integrity Check Value'' (multiple of 32 bits) : Variable length check value.  It may contain padding to align the field to an 8-octet boundary for [[IPv6]], or a 4-octet boundary for [[IPv4]].

===Encapsulating Security Payload===
[[File:Ipsec-esp-tunnel-and-transport.svg|thumb|Usage of IPsec Encapsulating Security Payload (ESP) in Tunnel and Transport modes]]
The IP Encapsulating Security Payload (ESP)&lt;ref&gt;{{cite web | url = http://www.toad.com/gnu/draft-ietf-sip-esp-00.txt | title = SIPP Encapsulating Security Payload | publisher = IETF SIPP Working Group | year = 1993 | access-date = 2013-08-07 | archive-url = https://web.archive.org/web/20160909031941/http://www.toad.com/gnu/draft-ietf-sip-esp-00.txt | archive-date = 2016-09-09 | url-status = dead }}&lt;/ref&gt; was developed at the [[Naval Research Laboratory]] starting in 1992 as part of a [[DARPA]]-sponsored research project, and was openly published by [[IETF]] SIPP&lt;ref&gt;{{cite web | url = http://tools.ietf.org/html/draft-ietf-sipp-spec-00 | title = Draft SIPP Specification | publisher = IETF | year = 1993 | page = 21}}&lt;/ref&gt; Working Group drafted in December 1993 as a security extension for SIPP. This [[#Encapsulating Security Payload|ESP]] was originally derived from the US Department of Defense [[SP3D]] protocol, rather than being derived from the ISO Network-Layer Security Protocol (NLSP). The SP3D protocol specification was published by [[NIST]] in the late 1980s, but designed by the Secure Data Network System project of the US Department of Defense. 
Encapsulating Security Payload (ESP) is a member of the IPsec protocol suite. It provides origin [[Information security#Authenticity|authenticity]] through source [[authentication]], [[data integrity]] through hash functions and [[confidentiality]] through [[encryption]] protection for IP [[Packet (information technology)|packet]]s. ESP also supports [[encryption]]-only and [[authentication]]-only configurations, but using encryption without authentication is strongly discouraged because it is insecure.&lt;ref&gt;{{cite conference | title=Problem Areas for the IP Security Protocols | booktitle=Proceedings of the Sixth Usenix Unix Security Symposium | first=Steven M. | last=Bellovin | year=1996 | pages=1–16 | place=San Jose, CA | url=https://www.cs.columbia.edu/~smb/papers/badesp.ps | accessdate=2007-07-09|authorlink=Steven M. Bellovin|format=[[PostScript]]}}&lt;/ref&gt;&lt;ref&gt;{{cite conference | title=Cryptography in theory and practice: The case of encryption in IPsec | booktitle=Eurocrypt 2006, Lecture Notes in Computer Science Vol. 4004 | last1=Paterson|first1=Kenneth G.|last2=Yau|first2=Arnold K.L.|date=2006-04-24|pages=12–29 | location=Berlin | url=http://eprint.iacr.org/2005/416 | accessdate=2007-08-13|format=PDF}}&lt;/ref&gt;&lt;ref&gt;{{cite conference | title=Attacking the IPsec Standards in Encryption-only Configurations | booktitle=IEEE Symposium on Security and Privacy, IEEE Computer Society |last1=Degabriele|first1=Jean Paul|last2=Paterson|first2=Kenneth G.|date=2007-08-09|format=PDF | pages=335–349 | location=Oakland, CA | url=http://eprint.iacr.org/2007/125 | accessdate=2007-08-13 }}&lt;/ref&gt;

Unlike [[Authentication Header|Authentication Header (AH)]], ESP in transport mode does not provide integrity and authentication for the entire [[IP packet (disambiguation)|IP packet]].&lt;!--intentional link to disambig--&gt; However, in [[Tunneling protocol|Tunnel Mode]], where the entire original IP packet is [[Information hiding|encapsulated]] with a new packet header added, ESP protection is afforded to the whole inner IP packet (including the inner header) while the outer header (including any outer IPv4 options or IPv6 extension headers) remains unprotected. ESP operates directly on top of IP, using IP protocol number 50.&lt;ref name=&quot;iana&quot;/&gt;

The following ESP packet diagram shows how an ESP packet is constructed and interpreted:&lt;ref name=&quot;rfc2406&quot;/&gt;&lt;ref name=rfc4303&gt;{{cite IETF|title=IP Encapsulating Security Payload (ESP)|last=Kent|first=S.|date=December 2005|publisher=[[Internet Engineering Task Force|IETF]]|rfc=4303|doi=10.17487/RFC4303}}&lt;/ref&gt;
&lt;center&gt;
{| class=&quot;wikitable&quot; style=&quot;text-align: center&quot;
|+ style=&quot;background:#781549; color:white;&quot; |''Encapsulating Security Payload'' format
|-
! style=&quot;border-bottom:none; border-right:none;&quot;| ''Offsets''
! style=&quot;border-left:none;&quot;| Octet&lt;sub&gt;16&lt;/sub&gt;
! colspan=&quot;8&quot; | 0
! colspan=&quot;8&quot; | 1
! colspan=&quot;8&quot; | 2
! colspan=&quot;8&quot; | 3
|-
! style=&quot;border-top: none&quot; | Octet&lt;sub&gt;16&lt;/sub&gt;
! Bit&lt;sub&gt;10&lt;/sub&gt;
! style=&quot;width:2.6%;&quot;| 0
! style=&quot;width:2.6%;&quot;| 1
! style=&quot;width:2.6%;&quot;| 2
! style=&quot;width:2.6%;&quot;| 3
! style=&quot;width:2.6%;&quot;| 4
! style=&quot;width:2.6%;&quot;| 5
! style=&quot;width:2.6%;&quot;| 6
! style=&quot;width:2.6%;&quot;| 7
! style=&quot;width:2.6%;&quot;| 8
! style=&quot;width:2.6%;&quot;| 9
! style=&quot;width:2.6%;&quot;| 10
! style=&quot;width:2.6%;&quot;| 11
! style=&quot;width:2.6%;&quot;| 12
! style=&quot;width:2.6%;&quot;| 13
! style=&quot;width:2.6%;&quot;| 14
! style=&quot;width:2.6%;&quot;| 15
! style=&quot;width:2.6%;&quot;| 16
! style=&quot;width:2.6%;&quot;| 17
! style=&quot;width:2.6%;&quot;| 18
! style=&quot;width:2.6%;&quot;| 19
! style=&quot;width:2.6%;&quot;| 20
! style=&quot;width:2.6%;&quot;| 21
! style=&quot;width:2.6%;&quot;| 22
! style=&quot;width:2.6%;&quot;| 23
! style=&quot;width:2.6%;&quot;| 24
! style=&quot;width:2.6%;&quot;| 25
! style=&quot;width:2.6%;&quot;| 26
! style=&quot;width:2.6%;&quot;| 27
! style=&quot;width:2.6%;&quot;| 28
! style=&quot;width:2.6%;&quot;| 29
! style=&quot;width:2.6%;&quot;| 30
! style=&quot;width:2.6%;&quot;| 31
|-
! 0
! 0
| colspan=&quot;32&quot;|''Security Parameters Index (SPI)''
|-
! 4
! 32
| colspan=&quot;32&quot;|''Sequence Number''
|-
! 8
! 64
|colspan=32 rowspan=2|''Payload data''
|-
! ...
! ...
|-
! ...
! ...
| colspan=8 style=&quot;border-top-style: hidden;&quot; | &amp;nbsp;
| colspan=24 style=&quot;border-bottom-style: hidden;&quot; | &amp;nbsp;
|-
! ...
! ...
| colspan=8 style=&quot;border-right-style: hidden;&quot; | &amp;nbsp;
| colspan=16 | ''Padding (0-255 octets)''
| colspan=8 style=&quot;border-left-style: hidden;&quot; | &amp;nbsp;
|-
! ...
! ...
| colspan=16 style=&quot;border-top-style: hidden;&quot; | &amp;nbsp;
| colspan=8 | ''Pad Length''
| colspan=8 | ''Next Header''
|-
! ...
! ...
| colspan=&quot;32&quot; rowspan=&quot;2&quot;|''Integrity Check Value (ICV)''&lt;br /&gt;...
|-
! ...
! ...
|}
&lt;/center&gt;
; ''Security Parameters Index'' (32 bits) : Arbitrary value used (together with the destination IP address) to identify the [[security association]] of the receiving party.
; ''Sequence Number'' (32 bits) : A [[monotonic]]ally increasing sequence number (incremented by 1 for every packet sent) to protect against [[replay attack]]s. There is a separate counter kept for every security association.
; ''Payload data'' (variable) : The protected contents of the original IP packet, including any data used to protect the contents (e.g. an Initialisation Vector for the cryptographic algorithm). The type of content that was protected is indicated by the ''Next Header'' field.
; ''Padding'' (0-255 octets) : Padding for encryption, to extend the payload data to a size that fits the encryption's [[Block cipher|cipher]] block size, and to align the next field.
; ''Pad Length'' (8 bits) : Size of the padding (in octets).
; ''Next Header'' (8 bits) : Type of the next header. The value is taken from the [[list of IP protocol numbers]].
; ''Integrity Check Value'' (multiple of 32 bits) : Variable length check value.  It may contain padding to align the field to an 8-octet boundary for [[IPv6]], or a 4-octet boundary for [[IPv4]].

===Security association===
{{main|Security association}}
The IPsec protocols use a [[security association]], where the communicating parties establish shared security attributes such as [[algorithms]] and keys. As such IPsec provides a range of options once it has been determined whether AH or ESP is used. Before exchanging data the two hosts agree on which algorithm is used to encrypt the IP packet, for example [[Data Encryption Standard|DES]] or [[International Data Encryption Algorithm|IDEA]], and which hash function is used to ensure the integrity of the data, such as [[MD5]] or [[Secure Hash Algorithms|SHA]]. These parameters are agreed for the particular session, for which a lifetime must be agreed and a [[session key]].&lt;ref&gt;{{Cite book|title= Carrier-Scale IP Networks: Designing and Operating Internet Networks|author =Peter Willis |publisher= IET|year=2001 |isbn= 9780852969823|page=271}}&lt;/ref&gt;

The algorithm for authentication is also agreed before the data transfer takes place and IPsec supports a range of methods. Authentication is possible through [[pre-shared key]], where a [[symmetric key]] is already in the possession of both hosts, and the hosts send each other hashes of the shared key to prove that they are in possession of the same key. IPsec also supports [[public key encryption]], where each host has a public and a private key, they exchange their public keys and each host sends the other a [[Cryptographic nonce|nonce]] encrypted with the other host's public key. Alternatively if both hosts hold a [[public key certificate]] from a [[certificate authority]], this can be used for IPsec authentication.&lt;ref&gt;{{Cite book|title= Carrier-Scale IP Networks: Designing and Operating Internet Networks|author =Peter Willis |publisher= IET|year=2001 |isbn= 9780852969823|pages=272–3}}&lt;/ref&gt;

The security associations of IPsec are established using the [[Internet Security Association and Key Management Protocol]] (ISAKMP). ISAKMP is implemented by manual configuration with pre-shared secrets, [[Internet Key Exchange]] (IKE and IKEv2), [[Kerberized Internet Negotiation of Keys]] (KINK), and the use of IPSECKEY [[list of DNS record types|DNS records]].&lt;ref name=&quot;RFC 4025&quot;/&gt;&lt;ref&gt;RFC 2406, §1, page 2&lt;/ref&gt;&lt;ref&gt;{{cite IETF |last1=Thomas |first1=M. |date=June 2001 |title=Requirements for Kerberized Internet Negotiation of Keys |rfc=3129 |doi=10.17487/RFC3129}}&lt;/ref&gt; RFC 5386 defines Better-Than-Nothing Security (BTNS) as an unauthenticated mode of IPsec using an extended IKE protocol.  C. Meadows, C. Cremers, and others have used [[Formal Methods]] to identify various anomalies which exist in IKEv1 and also in IKEv2.&lt;ref&gt;C. Cremers, Key Exchange in IPsec Revisited: Formal Analysis of IKEv1 and IKEv2, ESORICS 2011, published by Springer:  &quot;https://link.springer.com/chapter/10.1007/978-3-642-23822-2_18&quot;&lt;/ref&gt;

In order to decide what protection is to be provided for an outgoing packet, IPsec uses the [[Security Parameter Index]] (SPI), an index to the security association database (SADB), along with the destination address in a packet header, which together uniquely identifies a security association for that packet. A similar procedure is performed for an incoming packet, where IPsec gathers decryption and verification keys from the security association database.

For [[IP multicast]] a security association is provided for the group, and is duplicated across all authorized receivers of the group. There may be more than one security association for a group, using different SPIs, thereby allowing multiple levels and sets of security within a group. Indeed, each sender can have multiple security associations, allowing authentication, since a receiver can only know that someone knowing the keys sent the data. Note that the relevant standard does not describe how the association is chosen and duplicated across the group; it is assumed that a responsible party will have made the choice.

==Modes of operation==
The IPsec protocols AH and ESP can be implemented in a host-to-host transport mode, as well as in a network tunneling mode.
[[File:Ipsec-modes.svg|thumb|IPsec Modes]]

===Transport mode===
In transport mode, only the payload of the IP packet is usually [[encrypted]] or authenticated. The routing is intact, since the IP header is neither modified nor encrypted; however, when the [[Authentication Header|authentication header]] is used, the IP addresses cannot be modified by [[network address translation]], as this always invalidates the [[hash value]]. The [[transport layer|transport]] and [[application layer|application]] layers are always secured by a hash, so they cannot be modified in any way, for example by [[port address translation|translating]] the [[TCP and UDP port|port]] numbers.

A means to encapsulate IPsec messages for [[NAT traversal]] has been defined by [[Request for Comments|RFC]] documents describing the [[NAT-T]] mechanism.

===Tunnel mode ===
{{Main|Tunneling protocol}}
In tunnel mode, the entire IP packet is encrypted and authenticated. It is then encapsulated into a new IP packet with a new IP header. Tunnel mode is used to create [[virtual private network]]s for network-to-network communications (e.g. between routers to link sites), host-to-network communications (e.g. remote user access) and host-to-host communications (e.g. private chat).&lt;ref&gt;William, S., &amp; Stallings, W. (2006). Cryptography and Network Security, 4/E. Pearson Education India. p. 492-493&lt;/ref&gt;

Tunnel mode supports NAT traversal.

== Algorithms ==
===Symmetric encryption algorithms===
Cryptographic algorithms defined for use with IPsec include:
* [[HMAC]]-[[SHA1]]/[[SHA2]] for integrity protection and authenticity.
* [[TripleDES]]-[[Cipher block chaining|CBC]] for confidentiality
* AES-[[Cipher block chaining|CBC]] and [[AES-CTR]] for confidentiality.
* AES-[[Galois/Counter Mode|GCM]] and [[ChaCha20]]-[[Poly1305]] providing confidentiality and authentication together efficiently.

Refer to RFC 8221 for details.

===Key exchange algorithms===
* [[Diffie–Hellman key exchange|Diffie–Hellman]] (RFC 3526)
* [[Elliptic-curve Diffie–Hellman|ECDH]] (RFC 4753)

===Authentication algorithms===
* [[RSA (cryptosystem)|RSA]]
* [[ECDSA]] (RFC 4754)
* [[Pre-shared key|PSK]] (RFC 6617)

==Implementations==
The IPsec can be implemented in the IP stack of an [[operating system]], which requires modification of the source code. This method of implementation is done for hosts and security gateways. Various IPsec capable IP stacks are available from companies, such as HP or IBM.&lt;ref&gt;{{Cite book|title= Carrier-Scale IP Networks: Designing and Operating Internet Networks|author =Peter Willis |publisher= IET|year=2001 |isbn= 9780852969823|page=266}}&lt;/ref&gt; An alternative is so called [[bump-in-the-stack]] (BITS) implementation, where the operating system source code does not have to be modified. Here IPsec is installed between the IP stack and the network [[Device driver|drivers]]. This way operating systems can be retrofitted with IPsec. This method of implementation is also used for both hosts and gateways. However, when retrofitting IPsec the encapsulation of IP packets may cause problems for the automatic [[path MTU discovery]], where the [[maximum transmission unit]] (MTU) size on the network path between two IP hosts is established. If a host or gateway has a separate [[cryptoprocessor]], which is common in the military and can also be found in commercial systems, a so-called [[bump-in-the-wire]] (BITW) implementation of IPsec is possible.&lt;ref&gt;{{Cite book|title= Carrier-Scale IP Networks: Designing and Operating Internet Networks|author =Peter Willis |publisher= IET|year=2001 |isbn= 9780852969823|page=267}}&lt;/ref&gt;

When IPsec is implemented in the [[kernel (computer science)|kernel]], the key management and [[ISAKMP]]/[[Internet Key Exchange|IKE]] negotiation is carried out from user space. The NRL-developed and openly specified &quot;PF_KEY Key Management API, Version 2&quot; is often used to enable the application-space key management application to update the IPsec Security Associations stored within the kernel-space IPsec implementation.&lt;ref name=rfc2367&gt;RFC 2367, ''PF_KEYv2 Key Management API'', Dan McDonald, Bao Phan, &amp; Craig Metz (July 1998)&lt;/ref&gt; Existing IPsec implementations usually include ESP, AH, and IKE version 2.  Existing IPsec implementations on UNIX-like operating systems, for example, Solaris or Linux, usually include PF_KEY version 2.

Embedded IPsec can be used to ensure the secure communication among applications running over constrained resource systems with a small overhead.&lt;ref&gt;{{Cite book|last1=Hamad|first1=Mohammad|last2=Prevelakis|first2=Vassilis|date=2015|title=Implementation and performance evaluation of embedded IPsec in microkernel OS|journal=2015 World Symposium on Computer Networks and Information Security (WSCNIS)|language=en-US|publisher=IEEE|volume=|pages=|doi=10.1109/wscnis.2015.7368294|isbn=9781479999064|s2cid=16935000|url=https://publikationsserver.tu-braunschweig.de/receive/dbbs_mods_00065815}}&lt;/ref&gt;

==Standards status==
IPsec was developed in conjunction with [[IPv6]] and was originally required to be supported by all standards-compliant implementations of [[IPv6]] before RFC 6434 made it only a recommendation.&lt;ref name=rfc6434&gt;RFC 6434, &quot;IPv6 Node Requirements&quot;, E. Jankiewicz, J. Loughney, T. Narten (December 2011)&lt;/ref&gt; IPsec is also optional for [[IPv4]] implementations. IPsec is most commonly used to secure IPv4 traffic.{{citation needed|date=January 2019}}

IPsec protocols were originally defined in RFC 1825 through RFC 1829, which were published in 1995. In 1998, these documents were superseded by RFC 2401 and RFC 2412 with a few incompatible engineering details, although they were conceptually identical. In addition, a mutual authentication and key exchange protocol [[Internet Key Exchange]] (IKE) was defined to create and manage security associations. In December 2005, new standards were defined in RFC 4301 and RFC 4309 which are largely a superset of the previous editions with a second version of the Internet Key Exchange standard [[IKEv2]]. These third-generation documents standardized the abbreviation of IPsec to uppercase “IP” and lowercase “sec”.  “ESP” generally refers to RFC 4303, which is the most recent version of the specification.
